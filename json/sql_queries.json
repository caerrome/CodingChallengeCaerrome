{
    "number_quarter": "SELECT department, job, MAX(CASE WHEN Quarter = 'Q1' THEN cnt ELSE 0 END) AS Q1,  MAX(CASE WHEN Quarter = 'Q2' THEN cnt ELSE 0 END) AS Q2,  MAX(CASE WHEN Quarter = 'Q3' THEN cnt ELSE 0 END) AS Q3,  MAX(CASE WHEN Quarter = 'Q4' THEN cnt ELSE 0 END) AS Q4 FROM (SELECT B.department, C.job, Quarter, COUNT(*) as cnt FROM ((SELECT department_id, job_id, CASE WHEN (datetime >= '2021-01-01') AND (datetime <= '2021-03-31') THEN 'Q1' WHEN (datetime >= '2021-04-01') AND (datetime <= '2021-06-30') THEN 'Q2' WHEN (datetime >= '2021-07-01') AND (datetime <= '2021-09-30') THEN 'Q3' WHEN (datetime >= '2021-10-01') AND (datetime <= '2021-12-31') THEN 'Q4' END AS Quarter FROM hired_employees WHERE SUBSTR(datetime,1,4) = '2021')) AS A INNER JOIN departments AS B ON A.department_id = B.id INNER JOIN jobs as C ON A.job_id = C.id group by B.department, C.job, Quarter) AS A GROUP BY department, job order by department, job",
    "number_hired": "SELECT id, department, count as hired FROM (SELECT B.id, B.department, COUNT(*) AS count, AVG(COUNT(*)) OVER() AS mean FROM hired_employees AS A INNER JOIN departments AS B ON A.department_id = B.id INNER JOIN jobs as C ON A.job_id = C.id WHERE SUBSTR(datetime,1,4) = '2021' GROUP BY B.id, B.department ) AS A WHERE count > mean ORDER BY hired DESC"
}